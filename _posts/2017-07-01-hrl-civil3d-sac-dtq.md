---
layout: post
title:  "利用Civil3D装配设计器(SAC)建设高度形状自适应挡土墙"
categories: Civil3D AutoCAD
tags: Civil3D AutoCAD 部件 装配
author: 韩兰若
---
* content
{:toc}

各位亲好久不见。不好意思一直被琐事拖着很久没更新。

今天回过头来讲一下这个挡土墙。

首先介绍一下这个挡土墙。挡土墙是指支承路基填土或山坡土体、防止填土或土体变形失稳的构造物。

挡土墙通常长得比较复杂。

![](/img/2017/20170701-hrl-civil3d-sac-dtq-01.jpg)




在挡土墙横断面中，与被支承土体直接接触的部位称为墙背；与墙背相对的、临空的部位称为墙面；与地基直接接触的部位称为基底；与基底相对的、墙的顶面称为墙顶；基底的前端称为墙趾；基底的后端称为墙踵。

而且根据基坑的大小，深度不同，挡土墙的形状特别的多变。

比如说，这是我做过的一个挡土墙的设计要求。

![](/img/2017/20170701-hrl-civil3d-sac-dtq-02.jpg)

![](/img/2017/20170701-hrl-civil3d-sac-dtq-03.jpg)

简单的说，该墙的墙趾啊，墙踵啊，基底下面那个把儿啊，都是随着高度变化的，而高度是随着下面这个高程图变化的。

![](/img/2017/20170701-hrl-civil3d-sac-dtq-04.jpg)

![](/img/2017/20170701-hrl-civil3d-sac-dtq-05.jpg)

这个图里，最下面那条虚线是墙与地面的交点的高度，这里当做原点。

最上面的实线是墙的顶点的高度。

墙的高度H = 顶点高度 - 路面高度 （原点）

这里墙脚的高度是根据墙的高度H变化的值。

放在坐标系里如下：紫色是给定的参数，蓝色是可变的参数。考虑到道路中心线的走向，把方向左右反着画了。P是各点的标号。等下建模就按照这个图的记号走。

![](/img/2017/20170701-hrl-civil3d-sac-dtq-06.jpg)

因为过于复杂，C3D 现在有的装配显然不能满足要求。我们要自己建设装配。

了解了基本情况，打开subassembly composer

![](/img/2017/20170701-hrl-civil3d-sac-dtq-07.jpg)

界面基本介绍：

左上是工作流：就像编程开发之前需要有个流程图，写清楚谁运行完了运行谁那个，建模也需要构建一个流程，用来确定数据流向

左下是属性，给各点赋值用的。

右上是模型预览

右下是参数定义。

最开始先定义参数。在【输入、输出参数】页面点击【增加参数】就会多一个参数，重命名，添加初始值。然后定义下一个参数。

![](/img/2017/20170701-hrl-civil3d-sac-dtq-08.jpg)

最后添加完了如下：

![](/img/2017/20170701-hrl-civil3d-sac-dtq-09.jpg)

接下来确定一下参照平面。

由设计图和现场勘测，这里有两个参照平面，路面，地面，还有墙脚（现场勘测给定）那个面。

现在地面当坐标原点了，就定义路面和墙脚面就好了。

切到【目标参数】， 输入名字，类型为高程，随便赋一个初始值，预览可见平面出来了。

![](/img/2017/20170701-hrl-civil3d-sac-dtq-10.jpg)

现在可以正式创建流程了。

首先，参照平面的作用是确定初始点的位置，进而确定其他各点的位置。所以这里先处理初始点:

从左侧工具栏拖拽一个过程进来，命名。

![](/img/2017/20170701-hrl-civil3d-sac-dtq-12.jpg)

双击点进去。

先定义一个辅助点，就是模型图里那个A’， 在斜线上和路面所在平面的交点上。

工具栏选辅助点，几何类型为由角度和Y值判定。

接着出现角度和Y的文本框，角度92，y 值随便写一个，然后重要的是，高程目标选路面（优先于Y值）。

![](/img/2017/20170701-hrl-civil3d-sac-dtq-13.jpg)

预览可以看到该点在路面上。

继续添加斜墙的顶点和底点。根据模型图，顶点在路面以上1.5m

![](/img/2017/20170701-hrl-civil3d-sac-dtq-14.jpg)

底点就是墙脚的点，在墙脚平面上。

![](/img/2017/20170701-hrl-civil3d-sac-dtq-15.jpg)

接着把P1， P2补上。非常简单，从前一点出发水平或竖直偏移一定值就可以。顺便勾选【从点添加连线】，效果可见预览图

![](/img/2017/20170701-hrl-civil3d-sac-dtq-16.jpg)

初始点差不多设置完了，现在设置变量。添加一个流程叫变量。

![](/img/2017/20170701-hrl-civil3d-sac-dtq-17.jpg)

从工具栏添加一个变量。

这里最重要的变量就是H了。只有它 是自变量，其他人都是因变量，所以要先设置它。

H=P2.y-P10.y-0.8

这里赋值用的编程语言是VisualBasic

意思是P2的高度，也就是路面的高程，减去P10，墙脚高程，再减去墙脚埋进地里的深度0.8m

![](/img/2017/20170701-hrl-civil3d-sac-dtq-18.jpg)

类似地，其他的变量也一一赋值：

![](/img/2017/20170701-hrl-civil3d-sac-dtq-19.jpg)

![](/img/2017/20170701-hrl-civil3d-sac-dtq-20.jpg)

![](/img/2017/20170701-hrl-civil3d-sac-dtq-21.jpg)

![](/img/2017/20170701-hrl-civil3d-sac-dtq-22.jpg)

这些【 if 嵌套语句】都是根据设计要求表格里的设定写的，如果不满足条件就else， 直到满足为止。

可变变量赋值完成以后，就可以简单地根据图样用x, y 的偏移来设定每一个点了，不赘述。总之设置完了如下图所示。之前的模型都是点线，最后加一个形状，形成面。大功告成，保存好。

![](/img/2017/20170701-hrl-civil3d-sac-dtq-23.jpg)

打开C3D。

在工具面板里。右键插入装配。找到刚才做好的装配。塞进去。

![](/img/2017/20170701-hrl-civil3d-sac-dtq-24.jpg)

进来了。

![](/img/2017/20170701-hrl-civil3d-sac-dtq-25.jpg)

新建装配点。

这里介绍一下刚才那个装配应该怎么添加各种其他的装配。

我自己的画的图没了，找了一个图。

![](/img/2017/20170701-hrl-civil3d-sac-dtq-26.jpg)

可见除了墙顶和基底是由高程图确定的以外，墙背和墙面还要和周围的环境进行多切少填的融合。

体现在模型上就是

![](/img/2017/20170701-hrl-civil3d-sac-dtq-27.jpg)

上面那个红的是LotGrade

下面那个切坡的是BasicSideSlopeCutDitch

现在模型一应俱全。就差设计图了。

![](/img/2017/20170701-hrl-civil3d-sac-dtq-28.jpg)

先用附近的路转化为中心线（alignment），在现有地面（existing ground level）的基础上生成一个高程图（surface profile）。

![](/img/2017/20170701-hrl-civil3d-sac-dtq-29.jpg)

再根据现场测得的挡土墙的墙脚的点生成中心线（alignment），在中心线的基础上生成在现有地面（existing ground level）的高程（profile）。

![](/img/2017/20170701-hrl-civil3d-sac-dtq-30.jpg)

选择第一个图，选择投影。然后根据提示把选第一个图的高程线，投影到第二个图的高程表里。根据挡土墙的头和尾选择投影的区域。

![](/img/2017/20170701-hrl-civil3d-sac-dtq-31.jpg)

做好了如下。

![](/img/2017/20170701-hrl-civil3d-sac-dtq-32.jpg)

现在有了现有地面的高程了，还需要设计高程。用之前的教程里提到的Poly to Profile 工具，把设计高程的CAD图，做成高程图。

![](/img/2017/20170701-hrl-civil3d-sac-dtq-33.jpg)

变！

![](/img/2017/20170701-hrl-civil3d-sac-dtq-34.jpg)

接着把勘测出来的墙脚的点也做成profile。

![](/img/2017/20170701-hrl-civil3d-sac-dtq-35.jpg)

全家福

![](/img/2017/20170701-hrl-civil3d-sac-dtq-36.jpg)

到齐了。现在可以做了。

新建Corridor(我一直不知道这个中文软件里叫什么)

![](/img/2017/20170701-hrl-civil3d-sac-dtq-37.jpg)

设置目标

![](/img/2017/20170701-hrl-civil3d-sac-dtq-38.jpg)

生成

![](/img/2017/20170701-hrl-civil3d-sac-dtq-39.jpg)

![](/img/2017/20170701-hrl-civil3d-sac-dtq-40.jpg)

还可以生成实体

![](/img/2017/20170701-hrl-civil3d-sac-dtq-41.jpg)

![](/img/2017/20170701-hrl-civil3d-sac-dtq-42.jpg)

每站分析

![](/img/2017/20170701-hrl-civil3d-sac-dtq-43.jpg)

获取各点的高度报告

![](/img/2017/20170701-hrl-civil3d-sac-dtq-44.jpg)

坡度报告

![](/img/2017/20170701-hrl-civil3d-sac-dtq-45.jpg)

终于写完了，今天last day， 好累，求赞赏求安抚。

韩兰若发布于 2017-07-01